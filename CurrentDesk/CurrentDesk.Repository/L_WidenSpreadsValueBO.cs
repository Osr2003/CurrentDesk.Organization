using System;
using System.Linq;
using System.Collections.Generic;
using CurrentDesk.Models;
using System.Data.Objects;
using CurrentDesk.DAL;

//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated from a template at 12/25/2012 2:56:23 PM
//	   and this file should not get overridden 
//
//     Add your own data access methods.
// </auto-generated>
//------------------------------------------------------------------------------ 
	
namespace CurrentDesk.Repository.CurrentDesk
{   
	public class L_WidenSpreadsValueBO
	{
        /// <summary>
        /// This method returns all widen spread entries
        /// </summary>
        /// <returns></returns>
        public List<L_WidenSpreadsValue> GetWidenSpreadValues()
        {
            try
            {

                using (var unitOfWork = new EFUnitOfWork())
                {
                    var lWidenSpreadsValueRepo =
                        new L_WidenSpreadsValueRepository(new EFRepository<L_WidenSpreadsValue>(), unitOfWork);

                    //Returning List Of Demo Lead
                    return lWidenSpreadsValueRepo.All().ToList();

                }
            }
            catch(Exception ex)
            {
                CommonErrorLogger.CommonErrorLog(ex, System.Reflection.MethodBase.GetCurrentMethod().Name);
                throw;
            }
        }

        /// <summary>
        /// This method returns widen spread value from ID
        /// </summary>
        /// <param name="widenSpreadID">widenSpreadID</param>
        /// <returns></returns>
        public string GetWidenSpreadValueFromID(int widenSpreadID)
        {
            try
            {
                using (var unitOfWork = new EFUnitOfWork())
                {
                    var lWidenSpreadsValueRepo =
                        new L_WidenSpreadsValueRepository(new EFRepository<L_WidenSpreadsValue>(), unitOfWork);

                    ObjectSet<L_WidenSpreadsValue> lWidenSpreadObjSet =
                     ((CurrentDeskClientsEntities)lWidenSpreadsValueRepo.Repository.UnitOfWork.Context).L_WidenSpreadsValue;

                    return lWidenSpreadObjSet.Where(spread => spread.PK_WidenSpreadsID == widenSpreadID).FirstOrDefault().WidenSpreadsValue;
                }
            }
            catch (Exception ex)
            {
                CommonErrorLogger.CommonErrorLog(ex, System.Reflection.MethodBase.GetCurrentMethod().Name);
                throw;
            }
        }
		
	}
}