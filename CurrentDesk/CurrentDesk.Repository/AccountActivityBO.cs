using System;
using System.Linq;
using System.Collections.Generic;
using CurrentDesk.DAL;
using CurrentDesk.Models;
using CurrentDesk.Common;

//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated from a template at 13/5/2013 12:24:02 PM
//	   and this file should not get overridden 
//
//     Add your own data access methods.
// </auto-generated>
//------------------------------------------------------------------------------ 
	
namespace CurrentDesk.Repository.CurrentDesk
{   
	public class AccountActivityBO
	{
		// Add your own data access methods here.  If you wish to
		// expose your public method to a WCF service, marked them with
		// the attribute [NCPublish], and another T4 template will generate your service contract

        /// <summary>
        /// This method inserts account activity details in db
        /// </summary>
        /// <param name="pkActivityID">pkActivityID</param>
        /// <param name="currID">currID</param>
        /// <param name="newAccType">newAccType</param>
        /// <param name="pkClientAccID">pkClientAccID</param>
        public void InsertAccountActivityDetails(int pkActivityID, int currID, string newAccType, int? pkClientAccID)
        {
            try
            {
                using (var unitOfWork = new EFUnitOfWork())
                {
                    var accActRepo =
                        new AccountActivityRepository(new EFRepository<AccountActivity>(), unitOfWork);

                    AccountActivity newActivity = new AccountActivity();
                    newActivity.FK_AccActivityTypeID = (int)AccountActivityType.NewAccountCreation;
                    newActivity.Currency = currID;
                    newActivity.AccountType = newAccType;
                    newActivity.FK_UserActivityID = pkActivityID;
                    newActivity.FK_ClientAccountID = pkClientAccID;

                    accActRepo.Add(newActivity);
                    accActRepo.Save();
                }
            }
            catch (Exception ex)
            {
                CommonErrorLogger.CommonErrorLog(ex, System.Reflection.MethodBase.GetCurrentMethod().Name);
                throw;
            }
        }
	}
}